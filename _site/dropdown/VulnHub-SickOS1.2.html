<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>VulnHub - SickOS1.2</title>
  <meta name="description" content="Walkthrough - SickOS1.2">

  <!-- Social: Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@hunspook">
  <meta name="twitter:title" content="VulnHub - SickOS1.2">
  <meta name="twitter:description" content="Walkthrough - SickOS1.2">
  
  <meta property="twitter:image:src" content="https://hunspook.github.io/assets/img/opengraph.png">
  

  <!-- Social: Facebook / Open Graph -->
  <meta property="og:url" content="https://hunspook.github.io/dropdown/VulnHub-SickOS1.2.html">
  <meta property="og:title" content="VulnHub - SickOS1.2">
  
  <meta property="og:image" content="https://hunspook.github.io/assets/img/opengraph.png">
  
  <meta property="og:description" content="Walkthrough - SickOS1.2">
  <meta property="og:site_name" content="HunSpook">

  <!-- Social: Schema.org  -->
  <meta itemprop="name" content="VulnHub - SickOS1.2"/>
  <meta itemprop="description" content="Walkthrough - SickOS1.2">
  <meta itemprop="image" content="https://hunspook.github.io/assets/img/opengraph.png"/>

  <!-- Favicon -->
  <link rel="shortcut icon" href="/assets/img/icons/favicon.ico" type="image/x-icon" />

  <!-- Android Lolipop Theme Color -->
  <meta name="theme-color" content="#2a4d14">

  <!-- Styles -->
  <link rel="stylesheet" id="css-theme" href="/assets/css/main-dark.css">
  <link rel="stylesheet" href="/assets/css/highlight/gruvbox.css">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">

  <!-- Javascript -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.3.0/d3.min.js"></script>
  <script type="text/javascript" src="/assets/js/main.js"></script>
</head>


<body class="animated fadeIn">
  <div class="container">
    <div id="background-div">
      <svg id="background-svg">
        <lineargradient id="Gradient1" x1="0" x2="0" y1="0" y2="1">
          <stop stop-opacity="0" class="bgColor2" offset="0%" />
          <stop stop-opacity="0.5" class="bgColor2" offset="10%" />
          <stop stop-opacity="0.5" class="bgColor1" offset="40%" />
          <stop stop-opacity="0" class="bgColor1" offset="100%" />
        </lineargradient>
        <g id="bg-layer1"></g>
        <g id="bg-layer2" class="hide"></g>
        <g id="bg-layer3"></g>
        <g id="bg-layer4"></g>
      </svg>
    </div>
    <section class="header">
      <header>
  <div class="row">
    <div class="col-xs-12">
      <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
          <div class="navbar-header">
            <a class="navbar-toggle collapsed navbar-icon" data-toggle="collapse"
              data-target="#bs-example-navbar-collapse-1">
              <i class="fa fa-bars fa-2x"></i>
            </a>
            <a class="navbar-brand navbar-icon" href="/">
                <i class="fa fa-home fa-2x"></i>
            </a>
          </div>

          <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
              <li><a href="/">Home</a></li>
              

              
                <li class="dropdown dropdown-Cheatsheets">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown"
                    role="button" aria-haspopup="true" aria-expanded="false">Cheatsheets
                    <span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu dropdown-menu-Acerda De">
                    <li priority="1"><a href="/dropdown/Acerda-de-.html">Acerda De</a></li>
                  </ul>
                </li>
              
                <li class="dropdown dropdown-Cheatsheets">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown"
                    role="button" aria-haspopup="true" aria-expanded="false">Cheatsheets
                    <span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu dropdown-menu-Linux privilege escalation cheatsheet">
                    <li priority="1"><a href="/dropdown/Linux-privilege-escalation-cheatsheet.html">Linux privilege escalation cheatsheet</a></li>
                  </ul>
                </li>
              
                <li class="dropdown dropdown-Walkthroughs">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown"
                    role="button" aria-haspopup="true" aria-expanded="false">Walkthroughs
                    <span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu dropdown-menu-VulnHub - Mr. Robot">
                    <li priority="1"><a href="/dropdown/VulnHub-Mr.Robot.html">VulnHub - Mr. Robot</a></li>
                  </ul>
                </li>
              
                <li class="dropdown dropdown-Walkthroughs">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown"
                    role="button" aria-haspopup="true" aria-expanded="false">Walkthroughs
                    <span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu dropdown-menu-VulnHub - NullByte">
                    <li priority="1"><a href="/dropdown/VulnHub-NullByte.html">VulnHub - NullByte</a></li>
                  </ul>
                </li>
              
                <li class="dropdown dropdown-Walkthroughs">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown"
                    role="button" aria-haspopup="true" aria-expanded="false">Walkthroughs
                    <span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu dropdown-menu-VulnHub - Photographer">
                    <li priority="1"><a href="/dropdown/VulnHub-Photographer.html">VulnHub - Photographer</a></li>
                  </ul>
                </li>
              
                <li class="dropdown dropdown-Walkthroughs">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown"
                    role="button" aria-haspopup="true" aria-expanded="false">Walkthroughs
                    <span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu dropdown-menu-VulnHub - SickOS1.1">
                    <li priority="1"><a href="/dropdown/VulnHub-SickOS1.1.html">VulnHub - SickOS1.1</a></li>
                  </ul>
                </li>
              
                <li class="dropdown dropdown-Walkthroughs">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown"
                    role="button" aria-haspopup="true" aria-expanded="false">Walkthroughs
                    <span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu dropdown-menu-VulnHub - SickOS1.2">
                    <li priority="1"><a href="/dropdown/VulnHub-SickOS1.2.html">VulnHub - SickOS1.2</a></li>
                  </ul>
                </li>
              
                <li class="dropdown dropdown-Walkthroughs">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown"
                    role="button" aria-haspopup="true" aria-expanded="false">Walkthroughs
                    <span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu dropdown-menu-VulnHub - SkyTower">
                    <li priority="1"><a href="/dropdown/VulnHub-SkyTower.html">VulnHub - SkyTower</a></li>
                  </ul>
                </li>
              
                <li class="dropdown dropdown-Cheatsheets">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown"
                    role="button" aria-haspopup="true" aria-expanded="false">Cheatsheets
                    <span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu dropdown-menu-Windows privilege escalation cheatsheet">
                    <li priority="1"><a href="/dropdown/Windows-privilege-escalation-cheatsheet.html">Windows privilege escalation cheatsheet</a></li>
                  </ul>
                </li>
              
              

              <script>
                // clean repeated dropdowns and add <li> to their positions
                let done = [];
                let elements = [];
                $(".dropdown")
                  //
                  .each((index0 , value0) => {
                    let dropdownClass = "."+$(value0)[0].classList[1];
                    if (done.indexOf(dropdownClass) !== -1) return
                    done.push(dropdownClass)
                    let dropdownMain = $(dropdownClass)[0]
                    let itemsList = $(dropdownClass+">ul>li").sort((a, b) => parseInt(b.getAttribute("priority") || -9999999) - parseInt(a.getAttribute("priority") || -9999999))
                    $(dropdownClass+">ul>li").remove();
                    $(dropdownClass+">ul").append(itemsList)
                    $(dropdownClass).remove();
                    elements.push(dropdownMain)
                });
                let priority = [ "About",  "dropdown", ];
                elements = elements.concat(...$(".nav-item").remove())
                priority.map(text => {
                  elements = elements.filter(node => {
                      let nodeText = node.querySelector("a").textContent.trim()
                      if (text == nodeText) {
                          $(".nav").append(node)
                          return false;
                      }
                      return true;
                  })
                });
                $(".nav").append(elements)
              </script>
            </ul>
          </div>
        </div>
      </nav>
    </div>
  </div>
</header>

    </section>
    <section class="content">
      <div class="row">
        <!-- <div class="col-sm-2">
          <div class="pane-separator hidden-xs" style="margin-bottom:30em;"></div>
          <div class="left-pane">
          </div>
        </div> -->
        <div class="col-sm-8 col-sm-offset-2 content-div">
          <div class="page-separator hidden-xs">
            <h1 class="h1-strip" style="padding-bottom:8em; margin-bottom: 0;"></h1>
          </div>
          <div class="page-separator visible-xs">
            <h1 class="h1-strip" style="padding-bottom:2em; margin-bottom: 0;"></h1>
          </div>
          <h1 class="post-title page-title" id="title"><a href="#title">VulnHub - SickOS1.2</a></h1>
          <h2 id="vm-description">VM Description</h2>

<p>This CTF gives a clear analogy how hacking strategies can be performed on a network to compromise it in a safe environment. The objective being to compromise the network/machine and gain Administrative/root privileges on them.</p>

<p>It is second in following series from SickOs and is independent of the prior releases.</p>

<p>This CTF is a good training material for the OSCP certification.</p>

<p>Download: <a href="https://www.vulnhub.com/entry/sickos-12,144/">SickOS1.1</a></p>

<p>Author: <a href="https://www.vulnhub.com/author/telspace,90/">D4rk</a></p>

<h2 id="enumeration">Enumeration</h2>

<p>We configure the VM in bridge mode. In order to determine its assigned IP, we run the below command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$arp</span><span class="nt">-scan</span> <span class="nt">-I</span> wlan0 <span class="nt">-l</span> 
</code></pre></div></div>

<h4 id="service-enumeration">Service Enumeration</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$nmap</span> <span class="nt">-sV</span> <span class="nt">-sC</span> <span class="nt">-p-</span> <span class="nt">-oA</span> nmap/nmap 192.168.1.42
</code></pre></div></div>

<div class="row">
  <div class="col-md-6">
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Open port</th>
          <th>Service</th>
          <th>Version</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>22</td>
          <td> SSH </td>
          <td>OpenSSH 5.9p1</td>
        
        </tr>
        <tr>
         <td> 80 </td>
          <td> Http </td>
          <td> Lighttpd 1.4.28</td>
        </tr>
       </tbody>
    </table>
  </div>
</div>

<h4 id="web-server-directory-enumeration">Web Server Directory Enumeration</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$gobuster</span> <span class="nb">dir</span> <span class="nt">-u</span> http://192.168.1.42 <span class="nt">-w</span> /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt <span class="nt">-x</span> .php,.txt <span class="nt">-o</span> gobuster-80.txt
</code></pre></div></div>

<p>Gobuster returns only one indexed directory named test which we need to manually check.</p>

<p>Let’s see which methods are allowed by sending an OPTIONS request.</p>

<p><img src="../assets/img/Walkthroughs/sickos1.2/1.png" alt="options" /></p>

<p>Multiple methods are allowed including PUT.</p>

<h2 id="exploit">Exploit</h2>

<p>The exploit consists in uploading a <a href="https://github.com/pentestmonkey/php-reverse-shell">php reverse shell</a> using the PUT command. There are different ways to do that. To mention a few, we can use:</p>

<ol>
  <li>Nmap</li>
  <li>Burp Suite</li>
  <li>Curl/wget</li>
</ol>

<p>File upload using Nmap:
<img src="../assets/img/Walkthroughs/sickos1.2/2.png" alt="upload using nmap" /></p>

<p>File upload using Burp:
<img src="../assets/img/Walkthroughs/sickos1.2/3.png" alt="upload using burp" /></p>

<p>Files uploaded successfully:
<img src="../assets/img/Walkthroughs/sickos1.2/4.png" alt="list of uploads" /></p>

<p>Now that the reverse shell is uploaded successfully, let’s set up a Netcat listener and run it:</p>

<p><img src="../assets/img/Walkthroughs/sickos1.2/5.png" alt="reverse shell" /></p>

<p>Awesome! We have reverse shell as www-data.</p>

<h2 id="privilege-escalation">Privilege Escalation</h2>

<div class="panel panel-info">
      <div class="panel-heading">
        <h3 class="panel-title">Tip:</h3>
      </div>
      <div class="panel-body">
        When doing an old CTF (This one is from 2016), it is always important to note down the exact date the machine was released. This is because the target is probably vulnerable to multiple Kernel exploits by now. If we decide to look for kernel exploits, we need to check the PoC release date to see if it's older than the machine or not. 
      </div>
    </div>

<p>In this case, we don’t find kernel exploits disclosed before the machine release date. Since we want to resolve the machine the intended way, we can go ahead and look for other attack vectors. However, if you would like to test a kernel exploit either way, the target is vulnerable to <a href="https://www.exploit-db.com/exploits/40616">CVE-2016-5195.</a></p>

<p>You will need to comment out the payload for x86 architecture and uncomment the payload for x64 instead before compiling the exploit.</p>

<h4 id="privilege-escalation-the-intended-way">Privilege Escalation the intended way</h4>

<p>When looking for cron jobs, we notice the presence of chkrootkit and lighttpd. This is not the default configuration. Chances are, there is a vulnerability we can exploit.</p>

<p><img src="../assets/img/Walkthroughs/sickos1.2/6.png" alt="cron jobs" /></p>

<p>We check the version of chkrootkit. It’s 0.49.</p>

<p><img src="../assets/img/Walkthroughs/sickos1.2/7.png" alt="chkrootkit version" /></p>

<p>A quick google search returns that the target is vulnerable <a href="https://www.exploit-db.com/exploits/38775">CVE-2014-0476</a></p>

<p>We follow the steps described in the article and insert a payload into update under /tmp directory:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$cat</span> /tmp/update
<span class="c">#!/bin/bash</span>
<span class="nb">chown </span>root:root /bin/sh <span class="p">;</span> <span class="nb">chmod</span> +x 4777 /bin/sh
<span class="nv">$ </span><span class="nb">chmod</span> +x /tmp/update
</code></pre></div></div>

<p><img src="../assets/img/Walkthroughs/sickos1.2/8.png" alt="update" /></p>

<p>Now we can execute /bin/sh. We have the effective user id of root (0). Awesome.</p>

<p><img src="../assets/img/Walkthroughs/sickos1.2/10.png" alt="euid" /></p>

<p>Let’s read the flag :)</p>

<p><img src="../assets/img/Walkthroughs/sickos1.2/9.png" alt="reverse shell" /></p>


        </div>
        <div class="col-sm-2">
          <div class="pane-separator hidden-xs" style="margin-bottom:30em;"></div>
          <div class="pane-separator visible-xs" style="margin-bottom:5em;"></div>
          <div class="right-pane" style="margin-left: 1em;">
            
              <div class="avatar">
                <center>
                  
                    <img src="/assets/img/avatar.jpeg" alt="me" class="avatar-image">
                  
                  
                    <p class="avatar-description"></p>
                  
                  <div class="right-links">
                    
<a href="https://github.com/hunspook" target="_blank">
  <i class="fa fa-github fa-3x"></i>
</a>




<a href="https://twitter.com/hunspook" target="_blank">
  <i class="fa fa-twitter fa-3x"></i>
</a>



                  </div>
                </center>
              </div>
            
            
          </div>
        </div>
      </div>
    </section>
    <section class="footer">
      <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1894.4">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; text-align: center; font: 12.0px Times; color: #000000; -webkit-text-stroke: #000000}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1"></span></p>
<p class="p1"><span class="s1">
<a href="https://github.com/hunspook" target="_blank">
  <i class="fa fa-github fa-3x"></i>
</a>




<a href="https://twitter.com/hunspook" target="_blank">
  <i class="fa fa-twitter fa-3x"></i>
</a>


<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space"> </span></span></p>
</body>
</html>

    </section>
  </div>
</body>

</html>
